!function($){$.fn.jRating=function(a){var b={bigStarsPath:ACC.config.commonResourcePath+"/images/jRating/stars.png",smallStarsPath:ACC.config.commonResourcePath+"/images/jRating/small.png",phpPath:"php/jRating.php",type:"big",step:!1,isDisabled:!1,showRateInfo:!0,canRateAgain:!1,sendRequest:!0,length:5,decimalLength:0,rateMax:20,rateInfosX:-45,rateInfosY:5,nbRates:1,onSuccess:null,onError:null,onClick:null};if(this.length>0)return this.each(function(){var c=$.extend(b,a),j=0,e=0,d=0,f="",k=!1,l=0,m=c.nbRates;if($(this).hasClass("jDisabled")||c.isDisabled)var h=!0;else var h=!1;"small"===c.type?(e=12,d=10,f=c.smallStarsPath):(e=23,d=20,f=c.bigStarsPath),$(this).height(d);var i=parseFloat($(this).attr("data-average")),n=parseInt($(this).attr("data-id")),g=e*c.length,i=($("<div>",{class:"jRatingColor",css:{width:i/c.rateMax*g}}).appendTo($(this)),$("<div>",{class:"jRatingAverage",css:{width:0,top:-d}}).appendTo($(this)));function o(b){var d=parseFloat(100*b/g*parseInt(c.rateMax)/100),a=Math.pow(10,parseInt(c.decimalLength)),e=Math.round(d*a)/a;return e}function p(a){return a?a.offsetLeft+p(a.offsetParent):0}$("<div>",{class:"jStar",css:{width:g,height:d,top:-(2*d),background:"url("+f+") repeat-x"}}).appendTo($(this)),$(this).css({width:g,overflow:"hidden",zIndex:1,position:"relative"}),h||$(this).unbind().bind({mouseenter:function(a){var b=p(this),d=a.pageX-b;c.showRateInfo&&$("<p>",{class:"jRatingInfos",html:o(d)+' <span class="maxRate">/ '+c.rateMax+"</span>",css:{top:a.pageY+c.rateInfosY,left:a.pageX+c.rateInfosX}}).appendTo("body").show()},mouseover:function(a){$(this).css("cursor","pointer")},mouseout:function(){$(this).css("cursor","default"),k?i.width(l):i.width(0)},mousemove:function(a){var d=p(this),b=a.pageX-d;j=c.step?Math.floor(b/e)*e+e:b,i.width(j),c.showRateInfo&&$("p.jRatingInfos").css({left:a.pageX+c.rateInfosX}).html(o(j)+' <span class="maxRate">/ '+c.rateMax+"</span>")},mouseleave:function(){$("p.jRatingInfos").remove()},click:function(b){var d=this;k=!0,l=j,m--,(!c.canRateAgain||0>=parseInt(m))&&$(this).unbind().css("cursor","default").addClass("jDisabled"),c.showRateInfo&&$("p.jRatingInfos").fadeOut("fast",function(){$(this).remove()}),b.preventDefault();var a=o(j);i.width(j),$(".datasSent p").html("<strong>idBox : </strong>"+n+"<br /><strong>rate : </strong>"+a+"<br /><strong>action :</strong> rating"),$(".serverResponse p").html("<strong>Loading...</strong>"),c.onClick&&c.onClick(d,a),c.sendRequest&&$.post(c.phpPath,{idBox:n,rate:a,action:"rating"},function(b){b.error?($(".serverResponse p").html(b.server),c.onError&&c.onError(d,a)):($(".serverResponse p").html(b.server),c.onSuccess&&c.onSuccess(d,a))},"json")}})})}}(jQuery)